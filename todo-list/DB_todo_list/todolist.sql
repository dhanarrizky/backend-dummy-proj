-- createdb todolist;
CREATE TABLE account (
    username VARCHAR(50) PRIMARY KEY NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    phonenumber VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    Updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    deleted_at TIMESTAMP
)

CREATE INDEX idx_username ON account(username);

CREATE TABLE group (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    user_account VARCHAR(255) REFERENCES account(username) ON DELETE CASCADE,
    title VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    Updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    deleted_at TIMESTAMP
)

CREATE TABLE note (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    group_id BIGINT REFERENCES group(id) ON DELETE CASCADE,
    title VARCHAR(100),
    text_content TEXT,
    checked BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    Updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
    deleted_at TIMESTAMP
)


-- CREATE OR REPLACE FUNCTION update_timestamp()
-- RETURNS TRIGGER AS $$
-- BEGIN
--    NEW.updated_at = CURRENT_TIMESTAMP;
--    RETURN NEW;
-- END;
-- $$ LANGUAGE plpgsql;
